# 分镜大师 - 完整使用指南

## 📋 目录

1. [API 配置](#api-配置)
2. [核心功能](#核心功能)
3. [新增功能](#新增功能)
4. [视频生成](#视频生成)
5. [快速分镜](#快速分镜)
6. [常见问题](#常见问题)

---

## API 配置

### 第一步：启动应用

```bash
npm run dev
```

打开浏览器访问：`http://localhost:5173`

### 第二步：配置 AI 服务

点击左侧工具栏的 **⚙️ 设置** 按钮，进入 API 配置界面。

#### 支持的 AI 服务

| 服务商 | 模型 | 推荐度 | 说明 |
|--------|------|--------|------|
| **Gemini** | Gemini 2.0 Flash | ⭐⭐⭐⭐⭐ | 官方推荐，性能最佳 |
| **OpenAI** | GPT-4o | ⭐⭐⭐⭐ | 稳定可靠 |
| **智谱 AI** | ChatGLM | ⭐⭐⭐ | 国内服务 |
| **通义千问** | Qwen | ⭐⭐⭐ | 国内服务 |
| **DeepSeek** | DeepSeek Chat | ⭐⭐⭐ | 成本低 |

#### 配置步骤

**以 Gemini 为例：**

1. 访问 [Google AI Studio](https://ai.studio/apps/drive/1wkj1Wo9G2rTr2nQ8UPbb3VheY-hoIFap)
2. 获取 API Key
3. 在应用中选择 "Gemini"
4. 粘贴 API Key
5. 点击 "Test" 验证配置
6. 配置成功后自动保存

**其他服务配置类似，只需替换 API Key 和模型名称。**

### 第三步：验证配置

配置完成后，系统会自动测试连接。如果显示 ✅ 则配置成功。

---

## 核心功能

### 1️⃣ 剧本生成模式

**适用场景：** 有完整脚本或故事大纲

**操作步骤：**

1. 在左侧选择 **📝 剧本生成**
2. 输入完整的剧本或故事描述
3. 选择参数：
   - **画面比例**：16:9（电影）、9:16（短视频）等
   - **风格**：电影、科幻、赛博朋克等
   - **分镜数量**：2-12 张
4. 点击 **开始生成**
5. 等待 AI 生成分镜

**示例提示词：**

```
【场景1】
一个宽敞的办公室，阳光透过落地窗洒进来。
主角坐在办公桌前，表情严肃，正在看一份重要文件。

【场景2】
主角突然站起来，走向窗边。
背景是城市天际线，夕阳西下。

【场景3】
特写镜头：主角的脸部，眼神坚定。
```

### 2️⃣ 创意对话模式

**适用场景：** 逐步构思，需要 AI 协助完善

**操作步骤：**

1. 在左侧选择 **💬 创意对话**
2. 输入初步想法或创意概念
3. 与 AI 进行多轮对话，逐步完善细节
4. 确认满意后，点击 **生成分镜**
5. 选择参数并生成

**对话示例：**

```
用户：我想要一个关于未来城市的视频
AI：很好的想法！你想要什么样的未来城市？
   - 赛博朋克风格（霓虹灯、高科技）
   - 绿色生态风格（植物、自然）
   - 其他风格？

用户：赛博朋克风格，有飞行汽车
AI：完美！主要角色是什么？
   - 一个人物
   - 一辆飞行汽车
   - 城市景观

用户：一个人物在飞行汽车里
AI：我已经为你生成了分镜...
```

### 3️⃣ 参考主体功能

**用途：** 保持生成分镜中的角色/物体一致性

**操作步骤：**

1. 点击左侧 **📥 上传参考**
2. 选择角色或物体的图片
3. 系统会在生成分镜时保持该角色的一致性
4. 生成的所有分镜中，该角色的外观、服装、特征都会保持一致

**注意事项：**
- 上传清晰的正面照片效果最好
- 避免过度遮挡或模糊的图片
- 一次只能上传一个参考主体

### 4️⃣ 分镜编辑

**在画布上可以进行的操作：**

| 操作 | 快捷键/方式 | 说明 |
|------|-----------|------|
| 选择分镜 | 点击 | 单击选中一张分镜 |
| 多选 | Shift + 点击 | 逐个选中多张分镜 |
| 框选 | 鼠标拖拽 | 框选多张分镜 |
| 全选 | Ctrl + A | 选中所有分镜 |
| 删除 | Delete | 删除选中的分镜 |
| 缩放 | Ctrl + 滚轮 | 放大/缩小画布 |
| 拖拽 | 鼠标拖动 | 移动分镜位置 |
| 调整大小 | 拖拽边角 | 改变分镜尺寸 |
| 重绘 | 右键菜单 | 重新生成该分镜 |
| 克隆 | 右键菜单 | 复制该分镜 |

### 5️⃣ 导出功能

**导出为 JPEG：**

1. 选中要导出的分镜（Ctrl + A 全选）
2. 点击 **💾 保存生成**
3. 系统自动排版、编号、合成
4. 下载 JPEG 文件

**导出规则：**
- ✅ 所有分镜必须是同一比例
- ✅ 自动添加分镜编号（SC-01, SC-02...）
- ✅ 支持参考主体显示（红色虚线框）
- ✅ 自动调整布局以适应分镜数量

---

## 新增功能

### 🎬 多宫格生成 (Multi-Grid)

**功能说明：** 从不同摄像机角度生成同一物体/场景的多个视图

**核心特性：**
- 🎥 12 种摄像机角度智能选择
- 📐 自动计算最优网格布局
- 🔄 保证所有视图显示同一主体
- 📍 自动标注摄像机视角

**支持的摄像机角度：**

| 分类 | 角度 | 说明 |
|------|------|------|
| **特写** | 极端特写 | 宏观细节，1-2 单位距离 |
| | 特写 | 面部/细节，2-3 单位距离 |
| | 中特写 | 上半身，3-4 单位距离 |
| **中景** | 中景 | 腰部以上，4-5 单位距离 |
| | 中宽景 | 全身可见，5-6 单位距离 |
| | 宽景 | 完整场景，6-8 单位距离 |
| | 超宽景 | 全景视图，8-10 单位距离 |
| **特殊** | 俯视图 | 90° 俯视，鸟瞰视角 |
| | 仰视图 | -45° 仰视，向上看 |
| | 三角视图 | 45° 旋转，显示深度 |
| | 侧面视图 | 90° 侧面，侧面清晰 |
| | 极端俯视 | 85-90° 俯视，平面视角 |

**使用步骤：**

1. 点击左侧 **✨ 高级功能**
2. 切换到 **🔲 多宫格** 标签页
3. 点击 **多宫格** 按钮
4. 输入参数：
   - **帧数**：2-12（系统自动计算网格布局）
   - **主体描述**：要生成的物体/场景
   - **风格**：可选（电影、科幻等）
5. 点击 **生成**
6. 系统生成 N 个不同角度的视图

**网格布局对应表：**

| 帧数 | 布局 | 帧数 | 布局 |
|------|------|------|------|
| 2 | 2×1 | 7 | 7×1 |
| 3 | 3×1 | 8 | 4×2 |
| 4 | 2×2 | 9 | 3×3 |
| 5 | 5×1 | 10 | 5×2 |
| 6 | 3×2 | 11 | 11×1 |
| | | 12 | 4×3 |

**示例：**

```
主体：一个红色的苹果
帧数：6
生成结果：3×2 网格
- 第1张：极端特写（显示纹理）
- 第2张：特写（显示形状）
- 第3张：中特写（显示颜色）
- 第4张：中景（显示整体）
- 第5张：宽景（显示环境）
- 第6张：俯视图（显示顶部）
```

**重要提示：**
- ⚠️ 所有视图显示的是**同一个主体**，不是重新创作
- ⚠️ 只改变摄像机角度和距离，不改变主体本身
- ⚠️ 系统会自动在每个视图左上角标注摄像机角度

---

## 视频生成

### 🎥 视频生成功能

**前置要求：**
- 已配置视频 API（Sora 2 或 Sora 2 Pro）
- 有足够的配额

### 配置视频 API

**第一步：获取 API Key**

访问 [Sora API 官网](https://openai.com/sora) 获取 API Key

**第二步：在应用中配置**

1. 点击左侧 **⚙️ 设置**
2. 找到 **视频 API** 部分
3. 选择服务商：
   - **OpenAI Sora**（推荐）
   - **DYU API**（备选）
4. 输入 API Key
5. 点击 **Test** 验证
6. 保存配置

### 生成视频

**方式一：从分镜生成**

1. 在画布上选中要转换为视频的分镜
2. 点击 **🎬 生成视频**
3. 系统自动生成视频提示词
4. 选择参数：
   - **模型**：Sora 2（基础）/ Sora 2 Pro（专业）
   - **宽高比**：16:9（横屏）/ 9:16（竖屏）
   - **时长**：10秒 / 15秒 / 25秒
   - **高清**：启用 HD（仅 Pro 模型）
5. 点击 **生成**

**方式二：自定义提示词**

1. 点击 **🎬 生成视频**
2. 在提示词框中输入自定义内容
3. 选择参数
4. 点击 **生成**

### 视频参数详解

#### 模型选择

| 模型 | 时长 | 分辨率 | 成本 | 适用场景 |
|------|------|--------|------|---------|
| **Sora 2** | 最长 10 秒 | 1080p | 低 | 快速预览、测试 |
| **Sora 2 Pro** | 最长 25 秒 | 1080p | 中 | 专业制作、长视频 |

#### 宽高比

| 比例 | 用途 | 示例 |
|------|------|------|
| **16:9** | 电影、电视、YouTube | 标准宽屏 |
| **9:16** | 短视频、手机竖屏 | TikTok、抖音 |

#### 时长选择

| 时长 | 生成时间 | 文件大小 | 适用场景 |
|------|---------|---------|---------|
| **10 秒** | 2-5 分钟 | ~50MB | 快速测试 |
| **15 秒** | 5-10 分钟 | ~75MB | 标准视频 |
| **25 秒** | 10-20 分钟 | ~125MB | 完整故事 |

#### 高清模式

- ✅ 启用 HD：生成 1080p 高清视频，生成时间更长
- ❌ 关闭 HD：生成标准清晰度，生成时间较短

### 视频生成流程

```
1. 输入提示词
   ↓
2. 选择参数
   ↓
3. 提交生成请求
   ↓
4. 系统排队处理
   ↓
5. 实时显示进度
   ↓
6. 生成完成
   ↓
7. 下载视频
```

### 监控生成进度

生成过程中，系统会实时显示：
- 📊 当前进度百分比
- ⏱️ 已用时间
- 🔄 当前状态（排队中、处理中、完成）

### 常见视频提示词

**示例 1：产品展示**

```
一个苹果在旋转，展示其各个角度。
背景是白色的工作室，光线柔和。
摄像机缓慢环绕苹果，展示其完整形状。
```

**示例 2：场景转换**

```
镜头从城市街道开始，缓慢上升。
显示整个城市的天际线。
夕阳西下，天空呈现金色。
```

**示例 3：角色动作**

```
一个人物从左边走进画面。
他停下来，转身面向摄像机。
表情坚定，眼神有力。
```

### 视频生成常见问题

**Q: 为什么生成失败？**

常见原因：
- ❌ 提示词包含真人或类似真人的内容
- ❌ 提示词包含暴力、色情等违规内容
- ❌ 提示词包含版权内容或活着的名人
- ❌ 配额不足

**Q: 生成时间为什么这么长？**

- 25 秒视频需要 10-20 分钟
- 启用 HD 模式会增加生成时间
- 系统排队中也会增加等待时间

**Q: 如何加快生成速度？**

- 使用 Sora 2（而不是 Pro）
- 选择较短的时长（10 秒）
- 关闭 HD 模式
- 避免高峰时段

---

## 快速分镜

### ⚡ 快速分镜功能

**功能说明：** 一键生成特定类型的分镜组合

**4 种快速生成方式：**

#### 1. 三视图 (Three-View)

**用途：** 展示物体的三个正交视图（正面、侧面、顶面）

**生成步骤：**

1. 点击 **✨ 高级功能**
2. 切换到 **⚙️ 快速分镜** 标签页
3. 点击 **📐 三视图**
4. 输入主体描述（如"一个红色的椅子"）
5. 点击 **生成**
6. 系统生成 3 张视图

**生成结果：**
- 第 1 张：正面视图
- 第 2 张：侧面视图
- 第 3 张：顶面视图

#### 2. 多网格 (Multi-Grid)

**用途：** 从多个摄像机角度展示同一主体

**生成步骤：**

1. 点击 **✨ 高级功能**
2. 切换到 **⚙️ 快速分镜** 标签页
3. 点击 **🔲 多网格**
4. 输入参数：
   - **帧数**：2-12
   - **主体**：要展示的物体/场景
5. 点击 **生成**

**自动计算布局：**
- 2 帧 → 2×1 布局
- 4 帧 → 2×2 布局
- 6 帧 → 3×2 布局
- 9 帧 → 3×3 布局
- 12 帧 → 4×3 布局

#### 3. 风格对比 (Style Comparison)

**用途：** 同一场景用 5 种不同风格生成

**生成步骤：**

1. 点击 **✨ 高级功能**
2. 切换到 **⚙️ 快速分镜** 标签页
3. 点击 **🎨 风格对比**
4. 输入场景描述
5. 点击 **生成**

**生成的 5 种风格：**
- 电影风格
- 科幻风格
- 赛博朋克风格
- 水墨风格
- 动漫风格

#### 4. 叙事进展 (Narrative Progression)

**用途：** 生成一个故事的多个连续场景

**生成步骤：**

1. 点击 **✨ 高级功能**
2. 切换到 **⚙️ 快速分镜** 标签页
3. 点击 **📖 叙事进展**
4. 输入参数：
   - **帧数**：1-12
   - **故事描述**：故事大纲或场景描述
5. 点击 **生成**

**生成结果：**
- 按时间顺序生成多个场景
- 每个场景自动编号
- 场景之间保持视觉连贯性

### 自定义快速分镜模板

**修改默认模板：**

1. 点击 **✨ 高级功能**
2. 切换到 **⚙️ 快速分镜** 标签页
3. 点击 **⚙️ 设置** 按钮
4. 编辑模板提示词
5. 点击 **保存**

**重置为默认模板：**

1. 在模板编辑界面
2. 点击 **🔄 重置**
3. 确认重置

---

## 常见问题

### 生成相关

**Q: 为什么生成速度很慢？**

A: 
- 检查网络连接
- 确认 API 配额充足
- 尝试使用更简洁的提示词
- 避免高峰时段

**Q: 生成失败显示什么错误？**

A: 常见错误：
- "API Key 无效" → 检查 API Key 是否正确
- "配额不足" → 购买更多配额
- "提示词违规" → 修改提示词内容
- "网络超时" → 检查网络连接

**Q: 如何提高生成质量？**

A:
- 使用更详细的提示词
- 提供参考图片
- 选择合适的风格
- 使用高清模式（视频）

### 导出相关

**Q: 导出时提示"分镜必须是同一比例"？**

A: 系统要求导出的所有分镜使用同一比例。解决方案：
- 只选择同一比例的分镜导出
- 或分别导出不同比例的分镜

**Q: 导出的 JPEG 文件太大？**

A:
- 减少分镜数量
- 降低分镜分辨率
- 使用图片压缩工具

### 视频相关

**Q: 视频生成为什么这么贵？**

A: 视频生成成本高于图片生成：
- 25 秒视频需要大量计算资源
- 高清模式增加成本
- 建议先用 10 秒测试

**Q: 生成的视频质量不好？**

A:
- 检查提示词是否清晰
- 启用 HD 模式
- 使用 Sora 2 Pro 模型
- 提供参考图片

### 账户相关

**Q: 如何查看配额使用情况？**

A:
1. 点击左侧 **⚙️ 设置**
2. 查看 **配额信息** 部分
3. 显示已用/总配额

**Q: 配额用完了怎么办？**

A:
- 访问 AI 服务商官网
- 购买更多配额
- 或等待配额重置（通常每月重置）

---

## 快速参考

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + A` | 全选所有分镜 |
| `Shift + 点击` | 逐个选择分镜 |
| `Delete` | 删除选中分镜 |
| `Ctrl + 滚轮` | 缩放画布 |

### 推荐工作流

**场景 1：快速生成电影分镜**

```
1. 输入剧本 → 选择 16:9 比例 → 生成
2. 在画布上调整分镜
3. 导出为 JPEG
```

**场景 2：生成产品展示视频**

```
1. 上传产品参考图
2. 使用多宫格生成 6 个角度
3. 选择分镜 → 生成视频
4. 下载视频
```

**场景 3：创意故事创作**

```
1. 进入创意对话模式
2. 与 AI 讨论故事想法
3. 生成分镜
4. 使用叙事进展快速分镜
5. 导出最终结果
```

### 支持的文件格式

| 类型 | 格式 | 大小限制 |
|------|------|---------|
| 参考图片 | JPG, PNG, GIF | < 5MB |
| 导出分镜 | JPEG | 无限制 |
| 生成视频 | MP4 | 无限制 |

---

## 获取帮助

- 📖 查看应用内帮助：点击 **?** 按钮
- 🐛 报告问题：查看浏览器控制台错误信息
- 💬 联系支持：提供错误截图和操作步骤

---

**最后更新：2025 年 1 月**
