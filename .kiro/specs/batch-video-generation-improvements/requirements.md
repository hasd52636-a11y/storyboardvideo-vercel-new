# 批量视频生成改进 - 需求文档

## 介绍

本文档定义了批量视频生成功能的改进需求。当前实现存在三个主要问题：
1. 生成失败的视频无法定位，无法重新提交
2. 生成的视频和提示词没有对应标记，无法关联
3. 生成的视频没有下载按钮

## 术语表

- **Batch Generation**: 批量生成 - 一次性生成多个视频
- **Video Item**: 视频项 - 单个生成的视频及其元数据
- **Scene ID**: 场景ID - 唯一标识符，用于追踪场景和视频
- **Status**: 状态 - 视频生成的当前状态（pending/generating/success/failed）
- **Prompt Correspondence**: 提示词对应 - 视频和提示词之间的关联关系
- **Download Button**: 下载按钮 - 用户可点击的下载功能

## 需求

### 需求 1: 失败视频定位和重新提交

**用户故事**: 作为用户，我想知道哪个视频生成失败了，以便我可以重新提交失败的视频。

#### 接受标准

1. WHEN 批量生成视频时，THE 系统 SHALL 为每个视频分配唯一的场景ID（如 SC-01, SC-02 等）
2. WHEN 视频生成失败时，THE 系统 SHALL 在UI中清晰显示失败的场景ID和错误信息
3. WHEN 用户查看失败的视频时，THE 系统 SHALL 提供"重新生成"按钮，允许用户重新提交该视频
4. WHEN 用户点击"重新生成"按钮时，THE 系统 SHALL 使用原始提示词重新生成该视频
5. WHEN 视频生成状态改变时，THE 系统 SHALL 实时更新UI中的状态指示器（pending/generating/success/failed）

### 需求 2: 视频和提示词对应标记

**用户故事**: 作为用户，我想看到视频和提示词之间的清晰对应关系，以便我能够追踪每个视频的来源。

#### 接受标准

1. WHEN 显示生成的视频时，THE 系统 SHALL 在视频卡片上显示场景ID（如 SC-01）
2. WHEN 显示生成的视频时，THE 系统 SHALL 在视频卡片上显示对应的提示词摘要（前100个字符）
3. WHEN 用户悬停在视频卡片上时，THE 系统 SHALL 显示完整的提示词内容
4. WHEN 视频卡片显示时，THE 系统 SHALL 使用不同的颜色或图标区分不同的状态（生成中/成功/失败）
5. WHEN 批量生成多个视频时，THE 系统 SHALL 保持视频和提示词的一一对应关系

### 需求 3: 视频下载功能

**用户故事**: 作为用户，我想下载生成的视频，以便我可以在其他地方使用它。

#### 接受标准

1. WHEN 视频生成成功时，THE 系统 SHALL 在视频卡片上显示"下载"按钮
2. WHEN 用户点击"下载"按钮时，THE 系统 SHALL 下载视频文件到用户的本地设备
3. WHEN 下载视频时，THE 系统 SHALL 使用有意义的文件名（包含场景ID和时间戳）
4. WHEN 视频正在下载时，THE 系统 SHALL 显示下载进度指示器
5. WHEN 下载完成时，THE 系统 SHALL 显示成功提示信息

### 需求 4: 批量生成进度和统计

**用户故事**: 作为用户，我想看到批量生成的进度和统计信息，以便我了解生成的进展。

#### 接受标准

1. WHEN 批量生成开始时，THE 系统 SHALL 显示进度条（已完成/总数）
2. WHEN 批量生成进行中时，THE 系统 SHALL 实时更新进度信息
3. WHEN 批量生成完成时，THE 系统 SHALL 显示统计信息（成功数/失败数/总数）
4. WHEN 用户查看批量生成结果时，THE 系统 SHALL 提供筛选选项（显示全部/仅显示失败/仅显示成功）

### 需求 5: 视频数据持久化

**用户故事**: 作为用户，我想保存生成的视频信息，以便我可以在后续会话中访问它们。

#### 接受标准

1. WHEN 视频生成完成时，THE 系统 SHALL 将视频信息保存到本地存储
2. WHEN 用户刷新页面时，THE 系统 SHALL 恢复之前生成的视频列表
3. WHEN 用户清除本地存储时，THE 系统 SHALL 删除所有保存的视频信息
4. WHEN 视频URL过期时，THE 系统 SHALL 显示过期提示并提供重新生成选项

